SELECT clientes.Nome, count(agenda.id_cliente), sum(servicos.Valor) as Total_servico, clientes.Fidelizado FROM agenda LEFT JOIN servicos on servicos.Codigo = agenda.id_servico LEFT JOIN clientes on clientes.Id_cliente = agenda.id_cliente WHERE status_agenda='Agendado' AND data_agenda BETWEEN '2021-10-27' AND '2999-12-31' GROUP BY agenda.id_cliente ORDER BY TotaL_servico DESC