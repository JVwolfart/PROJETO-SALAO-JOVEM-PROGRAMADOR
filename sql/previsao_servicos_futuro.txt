SELECT servicos.Nome, count(id_servico), sum(servicos.Valor) as Total_servico FROM agenda LEFT JOIN servicos on servicos.Codigo = agenda.id_servico WHERE status_agenda='Agendado' AND data_agenda BETWEEN '2021-10-27' AND '2999-12-31' GROUP BY id_servico ORDER BY TotaL_servico DESC